extends ../layouts/template.pug

block head
  link(rel="stylesheet", href="/styles/resource-list.css") 
  link(rel="stylesheet", href="/styles/toggle-switch.css")
  script(src="/js/category-sorting.js", defer)

block content
  .content-container
    h1= title 

    // --- Sorting Options UI (Frontend) ---
    .sorting-controls
      .toggle-switch-group#sort-by-toggle(role="radiogroup", aria-label="Sort Articles By")
        each optionValue, optionKey in sortingOptions
          label.toggle-switch-button(for=`sort-${optionKey}`)
            input(
              type="radio",
              id=`sort-${optionKey}`,
              name="sort-order",
              value=optionKey
              checked=(optionKey === 'default') ? true : false
            )
            span.button-text= optionValue.label 
      
      // IMPORTANT: Embed the article data and sorting options for client-side JavaScript
      script.
        window.categoryArticles = !{JSON.stringify(content)};
        window.sortingOptions = !{JSON.stringify(sortingOptions)};
        window.currentCategoryIdentifier = '#{category}';

    // --- Article List Container ---
    #article-list-container.resource-list-container
      if content && content.length > 0
        - let lastGroup = null;
        ul.resource-list
          each article in content
            if article.group && article.group !== lastGroup
              h2.resource-group-title= article.group
              - lastGroup = article.group

            li
              a(href=`/${category}/${article.slug}`)= article.title
      else
        p No content found for this category.